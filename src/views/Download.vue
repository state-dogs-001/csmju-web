<template>
  <div class="container px-4 mx-auto">
    <div
      class="relative flex flex-col w-full min-w-0 mb-6 -mt-64 break-words bg-white rounded-lg shadow-xl"
    >
      <div class="px-6">
        <div class="mt-6 text-center">
          <h3 class="text-4xl font-semibold leading-normal text-blueGray-700">
            ดาวน์โหลดแบบฟอร์มเอกสารราชการ
          </h3>
          <p class="font-semibold leading-normal text-md text-blueGray-500">
            Download the form of Official Documents
          </p>
        </div>

        <div class="py-5 mt-10 text-center border-t border-blueGray-200">
          <div class="flex flex-wrap">
            <div class="flex flex-auto mt-4 block w-full overflow-x-auto">
              <div class="block w-full overflow-x-auto lg:w-12/12">
                <!-- Projects table -->
                <table
                  class="items-center w-full bg-transparent border-collapse"
                >
                  <thead>
                    <tr
                      class="text-blueGray-500 border-b-2 border-blueGray-500"
                    >
                      <th
                        class="px-6 py-3 text-sm font-semibold text-left uppercase align-middle whitespace-nowrap"
                      >
                        ลำดับ
                      </th>
                      <th
                        class="px-6 py-3 text-sm font-semibold text-left uppercase align-middle whitespace-nowrap"
                      >
                        แบบฟอร์มเอกสารราชการ
                      </th>
                      <th
                        class="px-6 py-3 text-sm font-semibold text-left uppercase align-middle whitespace-nowrap"
                      >
                        ดาวน์โหลด
                      </th>
                    </tr>
                  </thead>
                  <tbody class="text-left w-full">
                    <tr class="border-b">
                      <td
                        class="p-4 px-6 text-sm align-middle whitespace-nowrap"
                      >
                        1
                      </td>

                      <td class="p-4 px-2 text-sm align-middle">
                        <div>
                          <p class="w-full font-normal truncate-3">
                            แบบฟอร์มใบลาสำหรับคณาจารย์ และบุคลากร
                          </p>
                        </div>
                      </td>

                      <td
                        class="p-4 px-6 text-xs align-middle whitespace-nowrap"
                      >
                        <button
                          class="px-4 py-2 mb-1 mr-1 text-xs font-normal text-white uppercase transition-all duration-150 ease-linear bg-emerald-500 rounded-lg shadow-md outline-none active:bg-emerald-600 hover:shadow-md focus:outline-none"
                          type="button"
                        >
                          <i class="fas fa-arrow-down"></i>
                          <a
                            href="https://drive.google.com/file/d/19cz3sKjsIsrt6VHfBIsRcaJykbo6eIOv/view?usp=sharing"
                            class="ml-1 text-md font-bold"
                            target="_blank"
                            >Download</a
                          >
                        </button>
                      </td>
                    </tr>
                    <tr class="border-b">
                      <td
                        class="p-4 px-6 text-sm align-middle whitespace-nowrap"
                      >
                        2
                      </td>

                      <td class="p-4 px-2 text-sm align-middle">
                        <div>
                          <p class="font-normal truncate-3">
                            แบบฟอร์มใบลาสำหรับนักศึกษา
                          </p>
                        </div>
                      </td>

                      <td
                        class="p-4 px-6 text-xs align-middle whitespace-nowrap"
                      >
                        <button
                          class="px-4 py-2 mb-1 mr-1 text-xs font-normal text-white uppercase transition-all duration-150 ease-linear bg-emerald-500 rounded-lg shadow-md outline-none active:bg-emerald-600 hover:shadow-md focus:outline-none"
                          type="button"
                        >
                          <i class="fas fa-arrow-down"></i>
                          <a
                            href="https://drive.google.com/file/d/1yzmD-6t3a8kXi6efQLpFgYwjfhqQa3_Q/view?usp=sharing"
                            class="ml-1 text-md font-bold"
                            target="_blank"
                            >Download</a
                          >
                        </button>
                      </td>
                    </tr>
                    <tr class="border-b">
                      <td
                        class="p-4 px-6 text-sm align-middle whitespace-nowrap"
                      >
                        3
                      </td>

                      <td class="p-4 px-2 text-sm align-middle">
                        <div>
                          <p class="w-full font-normal truncate-3">
                            แบบฟอร์มใบเบิกค่ารักษาพยาบาล
                          </p>
                        </div>
                      </td>

                      <td
                        class="p-4 px-6 text-xs align-middle whitespace-nowrap"
                      >
                        <button
                          class="px-4 py-2 mb-1 mr-1 text-xs font-normal text-white uppercase transition-all duration-150 ease-linear bg-emerald-500 rounded-lg shadow-md outline-none active:bg-emerald-600 hover:shadow-md focus:outline-none"
                          type="button"
                        >
                          <i class="fas fa-arrow-down"></i>
                          <a
                            href="https://drive.google.com/file/d/1negMVCZX3aBSZpFTTVZCRUxGXNMmKx3s/view?usp=sharing"
                            class="ml-1 text-md font-bold"
                            target="_blank"
                            >Download</a
                          >
                        </button>
                      </td>
                    </tr>
                    <tr class="border-b">
                      <td
                        class="p-4 px-6 text-sm align-middle whitespace-nowrap"
                      >
                        4
                      </td>

                      <td class="p-4 px-2 text-sm align-middle">
                        <div>
                          <p class="w-full font-normal truncate-3">
                            ใบรับรองเวลาปฏิบัติงาน
                          </p>
                        </div>
                      </td>

                      <td
                        class="p-4 px-6 text-xs align-middle whitespace-nowrap"
                      >
                        <button
                          class="px-4 py-2 mb-1 mr-1 text-xs font-normal text-white uppercase transition-all duration-150 ease-linear bg-emerald-500 rounded-lg shadow-md outline-none active:bg-emerald-600 hover:shadow-md focus:outline-none"
                          type="button"
                        >
                          <i class="fas fa-arrow-down"></i>
                          <a
                            href="https://docs.google.com/document/d/1w1ZzmKxLJxg8IBXo5YK69op7JBQVP82v/edit?usp=sharing&ouid=107917108546787483081&rtpof=true&sd=true"
                            class="ml-1 text-md font-bold"
                            target="_blank"
                            >Download</a
                          >
                        </button>
                      </td>
                    </tr>
                    <tr class="border-b">
                      <td
                        class="p-4 px-6 text-sm align-middle whitespace-nowrap"
                      >
                        5
                      </td>

                      <td class="p-4 px-2 text-sm align-middle">
                        <div>
                          <p class="w-full font-normal truncate-3">
                            แบบแสดงความจำนงบริจาคเงิน
                          </p>
                        </div>
                      </td>

                      <td
                        class="p-4 px-6 text-xs align-middle whitespace-nowrap"
                      >
                        <button
                          class="px-4 py-2 mb-1 mr-1 text-xs font-normal text-white uppercase transition-all duration-150 ease-linear bg-emerald-500 rounded-lg shadow-md outline-none active:bg-emerald-600 hover:shadow-md focus:outline-none"
                          type="button"
                        >
                          <i class="fas fa-arrow-down"></i>
                          <a
                            href="https://docs.google.com/document/d/1lFwYXipcuarGpltNROL45hilltLgK1FH/edit?usp=sharing&ouid=107917108546787483081&rtpof=true&sd=true"
                            class="ml-1 text-md font-bold"
                            target="_blank"
                            >Download</a
                          >
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
//? Image
import icon from "../assets/images/paper.png";
//? API
import http from "../services/WebpageService";
//? Packages
import useValidate from "@vuelidate/core";
import { required, helpers } from "@vuelidate/validators";
export default {
  data() {
    return {
      icon,
      v$: useValidate(),

      Topic: "",
      Detail: "",

      showRecaptcha: true,
      date: new Date().toString(),

      imgUrl: "",
      file: null,

      verify: null,
    };
  },
  methods: {
    onFileSelected(event) {
      const file = event.target.files[0];
      this.file = event.target.files[0];
      this.imgUrl = URL.createObjectURL(file);
    },

    submit() {
      this.v$.$validate();
      if (!this.v$.$error) {
        if (this.verify != null) {
          const swalWithBootstrapButtons = this.$swal.mixin({
            customClass: {
              title: "font-semibold custom",
              confirmButton:
                "px-6 py-3 ml-3 custom mb-1 text-sm font-bold text-white uppercase transition-all duration-150 ease-linear rounded shadow outline-none bg-emerald-500 active:bg-emerald-600 hover:shadow-lg focus:outline-none",
              cancelButton:
                "px-6 py-3 custom mb-1 text-sm font-bold text-white uppercase transition-all duration-150 ease-linear rounded shadow outline-none bg-blueGray-700 active:bg-emerald-600 hover:shadow-lg focus:outline-none",
            },
            buttonsStyling: false,
          });

          swalWithBootstrapButtons
            .fire({
              title: "ยืนยันการส่งข้อมูล",
              icon: "warning",
              showCancelButton: true,
              confirmButtonText: "ยืนยัน",
              cancelButtonText: "ยกเลิก",
              reverseButtons: true,
            })
            .then((result) => {
              if (result.isConfirmed) {
                let data = new FormData();
                data.append("Complain_Title", this.Topic);
                data.append("Complain_Detail", this.Detail);
                data.append("Complain_Picture", this.file);
                data.append("Complain_Date", this.date);

                http.post("complain/create", data).then(() => {
                  this.Topic = null;
                  this.Detail = null;
                  this.file = null;
                  this.date = null;
                  this.imgUrl = null;
                  this.$refs.fileupload.value = null;

                  swalWithBootstrapButtons.fire(
                    "บันทึกข้อมูลเรียบร้อย!",
                    "",
                    "success"
                  );
                });
              } else if (result.dismiss === this.$swal.DismissReason.cancel) {
                this.Topic = null;
                this.Detail = null;
                this.file = null;
                this.date = null;
                this.imgUrl = null;

                this.$refs.fileupload.value = null;
                swalWithBootstrapButtons.fire(
                  "ยกเลิกการส่งข้อมูลเรียบร้อย!",
                  "",
                  "error"
                );
              }
            });
        } else {
          const Swal = this.$swal.mixin({
            position: "center",
            showConfirmButton: false,
            timer: 2000,
            timerProgressBar: true,
            customClass: {
              title: "font-semibold custom text-blueGray-600",
            },
          });

          Swal.fire({
            icon: "info",
            title: `กดยืนยัน "reCAPTCHA" ก่อน`,
          });
        }
      }
    },
    recaptchaVerified(response) {
      this.verify = response;
    },

    recaptchaExpired() {
      this.$refs.vueRecaptcha.reset();
    },
    recaptchaFailed() {},
  },
  validations() {
    return {
      Topic: {
        required: helpers.withMessage("ป้อนหัวข้อก่อน", required),
      },
      Detail: {
        required: helpers.withMessage("ป้อนรายละเอียดก่อน", required),
      },
    };
  },
};
</script>
